import{i as F,j as B,_ as N,d as R,k as w,m as S,r as n,o as p,e as j,w as r,a as o,n as i,p as q,c as g,q as K,u as m,F as I,s as P,t as $,h as D,v as U,x as E,y as H,z as k}from"./index.19b437e6.js";const e=F({loading:!1,input:null,messages:[{id:1,text:"Ol\xE1, em que posso ajudar?",sender:"bot",timestamp:new Date}],response:null,inputDisabled:!1,idChat:(Math.random()+1).toString(36).substring(7),userAvatarSrc:"src/assets/user.png",botAvatarSrc:"src/assets/bot.png"}),M={async enviarMsg(){var h;if((h=e.input)!=null&&h.trim()){e.inputDisabled=!0;const l={id:e.messages.length+1,text:e.input,sender:"user",timestamp:new Date};try{e.loading=!0;const s="https://ea25-186-235-82-54.ngrok-free.app";e.response=await B.post(`${s}/inference/`,{prompt:e.input,stop_words:["Pergunta:","User:"],temperature:.2,top_p:.2,top_k:40,frequency_penalty:2,presence_penalty:2.4,max_tokens:1024},{headers:{"content-type":"application/json"},timeout:6e4});const d=e.response.data.resposta;e.messages.push(l,{id:e.messages.length+2,text:d,sender:"bot",timestamp:new Date}),console.log(d),e.input=""}catch(s){console.error("Error sending message:",s),e.messages.push({id:e.messages.length+1,text:"Erro: N\xE3o foi poss\xEDvel conectar ao backend.",sender:"bot",timestamp:new Date})}finally{e.inputDisabled=!1,e.loading=!1}}}};const L={class:"message-content"},O={key:0},G={key:1,style:{"margin-top":"8px"}},J=["src"],Q={key:2},W={class:"fixed-bottom"},X={class:"input-bar"},Y=R({__name:"index",setup(h){const l=w(null),s=w(!1),d=w(!1);let c,y=[];const V=async()=>{if(s.value)c.state!=="inactive"&&c.stop();else{y=[];const C=await navigator.mediaDevices.getUserMedia({audio:!0});c=new MediaRecorder(C),c.ondataavailable=a=>y.push(a.data),c.onstop=async()=>{const a=new Blob(y,{type:"audio/webm"});if(a.size===0)return;const _=new FormData;_.append("audio",a),_.append("session_id",e.idChat);try{d.value=!0;const v="https://main-eye-patrick-mac.trycloudflare.com",u=await B.post(`${v}/audio-inference/`,_,{headers:{"Content-Type":"multipart/form-data"},timeout:32e4}),f=u.data.resposta,x=u.data.tts_audio_url,b=u.data.user_audio_url;e.messages.push({id:e.messages.length+1,text:"",sender:"user",timestamp:new Date,audioUrl:b}),e.messages.push({id:e.messages.length+2,text:f,sender:"bot",timestamp:new Date,audioUrl:x})}catch(v){console.error("\u274C Erro ao enviar \xE1udio:",v)}finally{d.value=!1,s.value=!1}},c.start(),s.value=!0}},T=()=>{E(()=>{l.value&&(l.value.scrollTop=l.value.scrollHeight)})};return S(()=>e.messages.length,async()=>{await E(),T()}),(C,a)=>{const _=n("v-app-bar"),v=n("v-textarea"),u=n("v-icon"),f=n("v-btn"),x=n("v-main"),b=n("v-progress-circular"),z=n("v-overlay"),A=n("v-app");return p(),j(A,null,{default:r(()=>[o(_,{app:"",flat:"",height:"42",class:"app-bar"},{default:r(()=>a[1]||(a[1]=[i("div",{class:"titulo-barra"},[i("img",{class:"logo",src:q,alt:"logo"}),i("span",{class:"titulo-texto"},"Polaris AI v2.1")],-1)])),_:1}),o(x,{class:"main-content"},{default:r(()=>[i("div",{class:"chat-scroll",ref_key:"chatContainer",ref:l},[(p(!0),g(I,null,K(m(e).messages,t=>(p(),g("div",{key:t.id,class:H(["message",{"user-message":t.sender==="user","bot-message":t.sender==="bot"}])},[i("div",L,[t.text&&!t.audioUrl?(p(),g("div",O,U(t.text),1)):k("",!0),t.audioUrl?(p(),g("div",G,[i("audio",{src:t.audioUrl,controls:"",class:"audio-player"},null,8,J)])):k("",!0),!t.text&&!t.audioUrl?(p(),g("em",Q,"\u26A0\uFE0F Mensagem vazia?")):k("",!0)])],2))),128))],512),i("div",W,[i("div",X,[o(v,{modelValue:m(e).input,"onUpdate:modelValue":a[0]||(a[0]=t=>m(e).input=t),label:"Type a message","hide-details":"",variant:"outlined",density:"compact",rows:"1",class:"flex-grow-1 mr-2 input-small-font",style:{"min-height":"34px"},onKeydown:P($(m(M).enviarMsg,["exact","prevent"]),["enter"])},null,8,["modelValue","onKeydown"]),o(f,{color:"primary",icon:"",onClick:m(M).enviarMsg,class:"mr-2",height:"34",width:"34"},{default:r(()=>[o(u,null,{default:r(()=>a[2]||(a[2]=[D("mdi-send")])),_:1})]),_:1},8,["onClick"]),o(f,{loading:d.value,color:s.value?"red darken-2":"secondary",icon:"",onClick:V,height:"34",width:"34"},{default:r(()=>[o(u,null,{default:r(()=>[D(U(s.value?"mdi-stop":"mdi-microphone"),1)]),_:1})]),_:1},8,["loading","color"])])])]),_:1}),o(z,{"model-value":m(e).loading,persistent:""},{default:r(()=>[o(b,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"])]),_:1})}}});var ee=N(Y,[["__scopeId","data-v-e54eda4e"]]);export{ee as default};
